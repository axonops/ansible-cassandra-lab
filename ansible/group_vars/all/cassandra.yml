---
# Common configuration for all environments

# Cassandra Configuration
cassandra_version: 5.0.5
cassandra_install_format: tar
cassandra_install_dir: /opt/cassandra

# Endpoint snitch for multi-DC setups
cassandra_endpoint_snitch: GossipingPropertyFileSnitch

# Data Directories for Cassandra
cassandra_data_root: /data/cassandra
cassandra_data_directory: "{{ cassandra_data_root }}/data"
cassandra_hints_directory: "{{ cassandra_data_root }}/hints"
cassandra_gc_log_dir: /var/log/cassandra
cassandra_saved_caches_directory: "{{ cassandra_data_root }}/saved_caches"
cassandra_log_dir: /var/log/cassandra
cassandra_commitlog_directory: "{{ cassandra_data_root }}/commitlog"

cassandra_authenticator: PasswordAuthenticator
cassandra_authorizer: CassandraAuthorizer

cassandra_auth_write_consistency_level: EACH_QUORUM
cassandra_use_statements_enabled: true

cassandra_start_on_boot: false

cassandra_audit_log_enabled: true
cassandra_audit_logging_options:
  enabled: true
  logger:
    - class_name: FileAuditLogger
  # Audit everything except QUERY (SELECT) and DML (INSERT, UPDATE, DELETE)
  included_categories: DDL,DCL,OTHER,AUTH,ERROR
  excluded_categories: QUERY,DML,PREPARE
  excluded_keyspaces: system, system_schema, system_virtual_schema
  block: false  # Don't block operations if audit queue is full
  max_queue_weight: 268435456  # 256MB - max audit events in memory

cassandra_bash_profile: false

# This is used by _keystore.yml to generate certs
cassandra_nodes: "{{ groups['cassandra'] | default(['cassandra1', 'cassandra2', 'cassandra3']) }}"
cassandra_node_ips: "{{ groups['cassandra'] | map('extract', hostvars, 'ansible_all_ipv4_addresses') | flatten | unique }}"

local_keystore_dir: "files/ssl/{{ env | default('dev-001') }}"

# THIS IS NOT RECOMMENDED FOR PRODUCTION USE. You must enter the IP address and not rely on auto-discovery
# cassandra_seeds: "{{ groups['cassandra'] | map('extract', hostvars, ['ansible_enp7s0.ipv4.address', 'address']) | first }}"
## DEFINED IN THE INVENTORY

#cassandra_listen_interface: "{{ ansible_default_ipv4.interface }}"

# Performance tuning (for SSD)
cassandra_concurrent_reads: 32
cassandra_concurrent_writes: 32
cassandra_concurrent_counter_writes: 32

cassandra_cluster_name: "{{ env }}"
# Set in the inventory
#Â cassandra_dc: "{{ cassandra_cluster_name }}-dc1"
cassandra_listen_address: "{{ ansible_enp7s0.ipv4.address }}"
cassandra_broadcast_rpc_address: "{{ ansible_eth0.ipv4.address }}"
cassandra_rpc_address: 0.0.0.0

# cassandra_broadcast_rpc_address: "{{ ansible_enp7s0.ipv4.address }}"
# cassandra_broadcast_address: "{{ ansible_enp7s0.ipv4.address }}"
# cassandra_listen_on_broadcast_address: true
cassandra_java_tmp_dir: /opt/tmp

# Define the JMX user and password for Cassandra (optional)
cassandra_jmx_user: "jmxuser"
cassandra_jmx_password: "jmxpassword"
cassandra_jmx_password_file: "/opt/cassandra/conf/jmxremote.password"
